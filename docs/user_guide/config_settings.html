

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Config Settings &mdash; Bigscity-TrafficDL  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Data Introduction" href="data.html" />
    <link rel="prev" title="Directory Structure" href="../get_started/directory_structure.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> Bigscity-TrafficDL
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Get Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../get_started/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../get_started/install.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="../get_started/quick_start.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../get_started/directory_structure.html">Directory Structure</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Config Settings</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#parameter-priority">Parameter Priority</a></li>
<li class="toctree-l2"><a class="reference internal" href="#command-line-parameters">Command Line Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#user-defined-configuration-file">User-defined Configuration File</a></li>
<li class="toctree-l2"><a class="reference internal" href="#default-configuration">Default Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#default-module-configuration">Default Module Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataset-config-file">Dataset Config File</a></li>
<li class="toctree-l3"><a class="reference internal" href="#task-config-file">Task Config File</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="data.html">Data Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="model.html">Model Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="evaluator.html">Evaluator Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="executor.html">Executor Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide/code_style.html">Code Style</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide/implemented_datasets.html">Customize Dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide/implemented_models.html">Customize Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide/implemented_executors.html">Customize Executors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide/implemented_logger.html">Logger</a></li>
</ul>
<p class="caption"><span class="caption-text">API REFERENCE</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../trafficdl/trafficdl.config.html">trafficdl.config</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trafficdl/trafficdl.data.html">trafficdl.data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trafficdl/trafficdl.evaluator.html">trafficdl.evaluator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trafficdl/trafficdl.executor.html">trafficdl.executor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trafficdl/trafficdl.model.html">trafficdl.model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trafficdl/trafficdl.pipeline.html">trafficdl.pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trafficdl/trafficdl.utils.html">trafficdl.utils</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Bigscity-TrafficDL</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Config Settings</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/user_guide/config_settings.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="config-settings">
<h1>Config Settings<a class="headerlink" href="#config-settings" title="Permalink to this headline">¶</a></h1>
<p>The experiment parameter configuration is determined by three aspects: the parameters passed by the command line, the user-defined configuration file, and the framework default configuration file. Therefore, the user can flexibly adjust the parameter configuration of the experiment through the first two methods.</p>
<div class="section" id="parameter-priority">
<h2>Parameter Priority<a class="headerlink" href="#parameter-priority" title="Permalink to this headline">¶</a></h2>
<p>command line parameters &gt; user-defined configuration file&gt; default parameters of the model module &gt; default parameters of other modules.</p>
<p><strong>The parameters with higher priority will override the parameters with the same name of lower priority.</strong></p>
<p>Considering that the optimal training parameters of different models are not consistent and the default training parameters of the executor can only be a fixed value, we designed to store the optimal training parameters of the model in its default configuration file and prioritize the default parameters of the model higher than other modules to solve this problem.</p>
</div>
<div class="section" id="command-line-parameters">
<h2>Command Line Parameters<a class="headerlink" href="#command-line-parameters" title="Permalink to this headline">¶</a></h2>
<p>When the user runs the script file in the project root directory, some parameters can be specified and modified through the command line. For example:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>python run_model.py --task traj_loc_pred --model DeepMove --dataset foursquare_tky --gpu <span class="nb">false</span> --batch_size <span class="m">15</span>
</pre></div>
</div>
<p>Different script files allow different parameters to be passed. For more details, please refer to the <a class="reference external" href="https://bigscity-trafficdl-docs.readthedocs.io/en/latest/user_guide/usage.html">Usage</a>.</p>
<p>You can also use <code class="docutils literal notranslate"><span class="pre">-h</span></code> to get help information, for example:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>&gt; python run_model.py -h
usage: run_model.py <span class="o">[</span>-h<span class="o">]</span> <span class="o">[</span>--task TASK<span class="o">]</span> <span class="o">[</span>--model MODEL<span class="o">]</span> <span class="o">[</span>--dataset DATASET<span class="o">]</span>
                    <span class="o">[</span>--config_file CONFIG_FILE<span class="o">]</span> <span class="o">[</span>--saved_model SAVED_MODEL<span class="o">]</span>
                    <span class="o">[</span>--train TRAIN<span class="o">]</span> <span class="o">[</span>--gpu GPU<span class="o">]</span> <span class="o">[</span>--batch_size BATCH_SIZE<span class="o">]</span>
                    <span class="o">[</span>--train_rate TRAIN_RATE<span class="o">]</span> <span class="o">[</span>--eval_rate EVAL_RATE<span class="o">]</span>
                    <span class="o">[</span>--learning_rate LEARNING_RATE<span class="o">]</span> <span class="o">[</span>--max_epoch MAX_EPOCH<span class="o">]</span>
                    <span class="o">[</span>--gpu_id GPU_ID<span class="o">]</span>

optional arguments:
  -h, --help            show this <span class="nb">help</span> message and <span class="nb">exit</span>
  --task TASK           the name of task
  --model MODEL         the name of model
  --dataset DATASET     the name of dataset
  --config_file CONFIG_FILE
                        the file name of config file
  --saved_model SAVED_MODEL
                        whether save the trained model
  --train TRAIN         whether re-train model <span class="k">if</span> the model is trained before
  --gpu GPU
  --batch_size BATCH_SIZE
  --train_rate TRAIN_RATE
  --eval_rate EVAL_RATE
  --learning_rate LEARNING_RATE
  --max_epoch MAX_EPOCH
  --gpu_id GPU_ID
</pre></div>
</div>
</div>
<div class="section" id="user-defined-configuration-file">
<h2>User-defined Configuration File<a class="headerlink" href="#user-defined-configuration-file" title="Permalink to this headline">¶</a></h2>
<p>Most of the parameters allowed on the command line are the parameters commonly passed in the experiment, like <code class="docutils literal notranslate"><span class="pre">batch_size</span></code>. Furthermore, in order to allow users to modify the default parameters of each module at will, the framework allows user to pass the user-defined config file’s name through the command line, and then reads in the parameter configuration from the user-defined configuration file. The user-defined config file should meet the following format requirements:</p>
<ol class="simple">
<li><p>The user-defined config file should be a <strong>JSON</strong> file.</p></li>
<li><p>The JSON file should store a dictionary, whose key is the <strong>parameter name</strong>, and the value is the <strong>parameter value</strong> to be modified.</p></li>
<li><p>The file should be placed in the <strong>project root directory</strong>, and its file name should be specified by <code class="docutils literal notranslate"><span class="pre">--config_file</span></code>.</p></li>
</ol>
<p>For example：</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
	<span class="nt">&quot;hidden_state_size&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
	<span class="nt">&quot;loc_embedding_size&quot;</span><span class="p">:</span> <span class="mi">500</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Users can modify the default parameters of any module by customizing the config file. For specific parameter names, you can refer to the user guide of each module for more information.</p>
</div>
<div class="section" id="default-configuration">
<h2>Default Configuration<a class="headerlink" href="#default-configuration" title="Permalink to this headline">¶</a></h2>
<div class="section" id="default-module-configuration">
<h3>Default Module Configuration<a class="headerlink" href="#default-module-configuration" title="Permalink to this headline">¶</a></h3>
<p>The default configuration of the data module, execution module, evaluation module, and model module are located in the following four directories respectively:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">/trafficdl/config/data</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">/trafficdl/config/executor</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">/trafficdl/config/evaluator</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">/trafficdl/config/model</span></code></p></li>
</ul>
<p>The file naming rule in each directory is <code class="docutils literal notranslate"><span class="pre">classname.json</span></code>. For example, for the execution module of traffic state prediction, the default configuration parameter file is <code class="docutils literal notranslate"><span class="pre">TrafficStateExecutor.json</span></code>.</p>
</div>
<div class="section" id="dataset-config-file">
<h3>Dataset Config File<a class="headerlink" href="#dataset-config-file" title="Permalink to this headline">¶</a></h3>
<p>We store some auxiliary information of the dataset in the configuration file of the dataset, whose storage path is <code class="docutils literal notranslate"><span class="pre">/raw_data/DataSet_Name/config.json</span></code>. Please refer to the <a class="reference internal" href="data/atomic_files.html"><span class="doc">atomic file</span></a> chapter for more information.</p>
</div>
<div class="section" id="task-config-file">
<h3>Task Config File<a class="headerlink" href="#task-config-file" title="Permalink to this headline">¶</a></h3>
<p>The task configuration file is used to record the list of models and datasets that can be supported by various tasks, as well as the default dataset class name, executor class name, and evaluation class name of each model, whose storage path is <code class="docutils literal notranslate"><span class="pre">/trafficdl/config/task_config.json</span></code>.</p>
<p>Here is an example of task config file:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;traj_loc_pred&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;allowed_model&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;DeepMove&quot;</span><span class="p">],</span>
    <span class="nt">&quot;allowed_dataset&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;foursquare_tky&quot;</span><span class="p">,</span> <span class="s2">&quot;gowalla&quot;</span><span class="p">],</span>
    <span class="nt">&quot;DeepMove&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;dataset_class&quot;</span><span class="p">:</span> <span class="s2">&quot;TrajectoryDataset&quot;</span><span class="p">,</span>
      <span class="nt">&quot;executor&quot;</span><span class="p">:</span> <span class="s2">&quot;TrajLocPredExecutor&quot;</span><span class="p">,</span>
      <span class="nt">&quot;evaluator&quot;</span><span class="p">:</span> <span class="s2">&quot;TrajLocPredEvaluator&quot;</span><span class="p">,</span>
      <span class="nt">&quot;traj_encoder&quot;</span><span class="p">:</span> <span class="s2">&quot;StandardTrajectoryEncoder&quot;</span>
  <span class="p">},</span>
  <span class="nt">&quot;traffic_state_pred&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;allowed_model&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;DCRNN&quot;</span><span class="p">],</span>
    <span class="nt">&quot;allowed_dataset&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;METR_LA&quot;</span><span class="p">,</span> <span class="s2">&quot;PEMS_BAY&quot;</span><span class="p">,</span> <span class="s2">&quot;PEMSD3&quot;</span><span class="p">],</span>
    <span class="nt">&quot;DCRNN&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;dataset_class&quot;</span><span class="p">:</span> <span class="s2">&quot;TrafficStatePointDataset&quot;</span><span class="p">,</span>
        <span class="nt">&quot;executor&quot;</span><span class="p">:</span> <span class="s2">&quot;DCRNNExecutor&quot;</span><span class="p">,</span>
        <span class="nt">&quot;evaluator&quot;</span><span class="p">:</span> <span class="s2">&quot;TrafficStateEvaluator&quot;</span>
    <span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>You need to modify the <code class="docutils literal notranslate"><span class="pre">trafficdl/config/task_config.json</span></code> file when adding new models.</strong></p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="data.html" class="btn btn-neutral float-right" title="Data Introduction" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../get_started/directory_structure.html" class="btn btn-neutral float-left" title="Directory Structure" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, aptx1231

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>